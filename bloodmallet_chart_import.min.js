"use strict";

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function bloodmallet_chart_import() {
  var e = ["#7cb5ec", "#d9d9df", "#90ed7d", "#f7a35c", "#8085e9", "#f15c80", "#e4d354", "#2b908f", "#f45b5b", "#91e8e1"],
      t = "#343a40",
      o = "#f8f9fa",
      a = "#828282",
      l = "1.1rem",
      r = !1,
      n = "https://bloodmallet.com/chart/get/",
      i = {
    cn: "cn_CN",
    en: "en_US",
    de: "de_DE",
    es: "es_ES",
    fr: "fr_FR",
    it: "it_IT",
    ko: "ko_KR",
    pt: "pt_BR",
    ru: "ru_RU",
    "zh-hans": "cn_CN"
  },
      s = {
    Kyrian: {
      id: 1,
      color: "#69ccf0"
    },
    Venthyr: {
      id: 2,
      color: "#c41f3b"
    },
    "Night Fae": {
      id: 3,
      color: "#a330c9"
    },
    Necrolord: {
      id: 4,
      color: "#abd473"
    }
  },
      d = {
    1: 145,
    2: 158,
    3: 171,
    4: 184,
    5: 200,
    6: 213,
    7: 226
  };

  function c(e) {
    r && console.log("load_data");
    var t = e.chart_id,
        o = e.data_type,
        a = e.fight_style,
        l = e.wow_class,
        i = e.wow_spec;

    try {
      if (h(e)) return;
    } catch (e) {
      r && console.log("Data needs to be loaded.");
    }

    var s = o;
    s.indexOf("azerite") > -1 && (s = "azerite_traits");
    var d = a;
    d += "/" + l, d += "/" + i;
    var c = "";
    c = t ? n + t : n + s + "/" + d;
    var u = new XMLHttpRequest();
    r && console.log("Fetching data from: " + c), u.open("GET", c, !0), u.onload = function (t) {
      if (4 === u.readyState) if (200 === u.status) {
        var _t = JSON.parse(u.responseText);

        e.html_element.dataset.loadedData = u.responseText, r && (console.log(_t), console.log("Load and save finished."));
      } else console.error(u.statusText);
    }, u.onerror = function (e) {
      console.error("Fetching data from bloodmallet.com encountered an error, ", e);
    }, u.send(null);
  }

  function h(e) {
    return JSON.parse(e.html_element.dataset.loadedData);
  }

  function u(e, t, o, a) {
    r && console.log("update_chart");
    var l = e.data_type,
        n = e.limit,
        i = e.chart_engine,
        c = !1;

    try {
      c = h(e);
    } catch (l) {
      return void (a < 30 && setTimeout(u, 200, e, t, o, a + 1));
    }

    if (!0 === c.error) return function (e, t) {
      var o = e;
      o.innerHTML = "";
      var a = document.createElement("p");
      a.innerText = "An error occured during simulation.", o.appendChild(a);
      var l = document.createElement("ul"),
          r = document.createElement("li");
      r.textContent = "Title: " + (t.title ? t.title : "~"), l.appendChild(r);
      var n = document.createElement("li");
      n.textContent = "Spec: " + t.wow_spec + " " + t.wow_class, l.appendChild(n);
      var i = document.createElement("li");
      i.textContent = "Type: " + t.simulation_type, l.appendChild(i);
      var s = document.createElement("li");
      s.textContent = "Fight style: " + t.fight_style, l.appendChild(s);
      var d = document.createElement("li");
      d.textContent = "ID: " + t.id, l.appendChild(d);
      var c = document.createElement("li");
      c.textContent = "Custom profile:", l.appendChild(c), c.appendChild(document.createElement("br"));
      var h = document.createElement("textarea");
      h.readOnly = !0, h.value = t.custom_profile, h.placeholder = "No custom profile", h.style.width = "100%", c.appendChild(h);
      var u = document.createElement("li");
      u.textContent = "Log:", l.appendChild(u), u.appendChild(document.createElement("br"));
      var p = document.createElement("textarea");
      p.readOnly = !0, p.value = t.log, p.placeholder = "No log available", p.style.width = "100%", u.appendChild(p), o.appendChild(l);
    }(t, c);
    if (wow_class = c.simc_settings.class, wow_spec = c.simc_settings.spec, fight_style = c.simc_settings.fight_style, e.data_type = l = c.data_type, function (e, t) {
      if (!["bloodmallet.com", "127.0.0.1:8000"].includes(window.location.host)) return;
      r && console.log("provide_meta_data");
      ["trinkets", "covenants", "conduits", "soulbind_nodes", "legendaries", "soulbinds"].includes(e.data_type) && (document.getElementById("value_style_switch").hidden = !1);
      document.getElementById("meta-info").hidden = !1;

      for (var _e in t.simc_settings) {
        var _o = document.createTextNode(t.simc_settings[_e]),
            _a = document.getElementById("c_" + _e);

        _a.innerText = "", _a.appendChild(_o);
      }

      var o = document.createElement("a");
      o.href = "https://github.com/simulationcraft/simc/commit/" + t.simc_settings.simc_hash, o.innerText = t.simc_settings.simc_hash.substring(0, 7);
      var a = document.getElementById("c_simc_hash");
      a.innerText = "", a.appendChild(o);

      for (var _e2 in t.profile.character) {
        try {
          var _o2 = document.getElementById("c_" + _e2);

          _o2.innerHTML = "";

          var _a2 = document.createTextNode(t.profile.character[_e2].split(" ").map(function (e) {
            return e[0].toUpperCase() + e.substring(1);
          }).join(" "));

          _o2.appendChild(_a2);
        } catch (e) {}
      }

      var l = void 0 !== t.profile.character.talents ? t.profile.character.talents : "0000000";
      var n = document.getElementById("c_talents");
      n.innerHTML = "";

      for (var _o3 = 0; _o3 < l.length; _o3++) {
        var _a3 = l[_o3];

        var _r = document.createElement("a");

        _r.href = "", _r.href = "https://" + ("en" === e.language ? "www" : e.language) + ".wowhead.com/";

        try {
          _r.href += "spell=" + t.talent_data[parseInt(_o3) + 1][parseInt(_a3)].spell_id;
        } catch (e) {
          continue;
        }

        _r.dataset.whIconSize = "medium", n.appendChild(_r);
      }

      for (var _o4 in t.profile.items) {
        var _a4 = document.createElement("a");

        _a4.href = "", _a4.href = "https://" + ("en" === e.language ? "www" : e.language) + ".wowhead.com/", _a4.href += "item=" + t.profile.items[_o4].id;
        var _l = [];

        try {
          _l.push("bonus=" + t.profile.items[_o4].bonus_id.split("/").join(":"));
        } catch (e) {}

        try {
          t.profile.items[_o4].hasOwnProperty("ilevel") && _l.push("ilvl=" + t.profile.items[_o4].ilevel);
        } catch (e) {}

        _l.length > 0 && (_a4.href += "?" + _l.join("&")), _a4.dataset.whIconSize = "medium";

        var _r2 = document.getElementById("c_" + _o4);

        _r2.innerHTML = "", _r2.appendChild(_a4);
      }

      "talents" === e.data_type && (document.getElementById("talent-warning").hidden = !1, function (e, t) {
        r && console.log("build_talent_table");
        document.getElementById("talent-table").hidden = !1;
        var o = [];

        for (var _e3 = 1; _e3 < 8; _e3++) {
          for (var _t2 = 1; _t2 < 4; _t2++) {
            o.push(_e3.toString() + _t2.toString());
          }
        }

        for (var _i = 0; _i < o.length; _i++) {
          var _a5 = _o5[_i];

          var _o5 = document.getElementById(_a5);

          try {
            var _l2 = document.createElement("h5"),
                _n = t.talent_data[_a5.slice(0, 1)][_a5.slice(1, 2)];

            _l2.innerHTML = z(e, _n.name, _a5, t), _o5.innerHTML = "", _o5.appendChild(_l2), _o5.appendChild(A("Mean", I(_a5, t))), _o5.appendChild(A("Min", O(_a5, t)[1], O(_a5, t)[0])), _o5.appendChild(A("Max", M(_a5, t)[1], M(_a5, t)[0]));

            var _i2 = L(_a5, t),
                _s = _i2.slice(0, _a5.slice(0, 1) - 1) + "0" + _i2.slice(_a5.slice(0, 1), 8),
                _d = t.data[_i2],
                _c = t.data[_s];

            _o5.appendChild(A("Max dps", S(_c, _d), _i2)), _i2 = L(_a5, t);

            var _h = S(t.data[t.sorted_data_keys[0]], t.data[_i2]);

            _o5.appendChild(A("Max dps minus global best", _h, _i2));
          } catch (e) {
            _o5.innerHTML = "-", r && console.warn(e);
          }
        }

        $(function () {
          $('[data-toggle="tooltip"]').tooltip();
        });
      }(e, t));

      if ("soulbinds" === e.data_type) {
        var _o6 = document.getElementById("post_chart");

        _o6.hidden = !1, _o6.innerHTML = "", Object.keys(t.covenant_ids).forEach(function (a) {
          var l = t.covenant_ids[a];
          var r = document.createElement("h3");
          r.appendChild(document.createTextNode(E(a, t, e))), _o6.appendChild(r);
          var n = 0;
          var i = y(e, _(e, t), t);
          var _iteratorNormalCompletion = true;
          var _didIteratorError = false;
          var _iteratorError = undefined;

          try {
            for (var _iterator = i[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
              var _a6 = _step.value;

              if (t.covenant_mapping[_a6].indexOf(l) > -1) {
                n += 1;

                var _l3 = document.createElement("h4");

                _l3.appendChild(document.createTextNode(n + ". " + E(_a6, t, e))), _l3.classList += "ml-3", _l3.id = _a6, _o6.appendChild(_l3);

                var _r3 = document.createElement("p");

                _r3.classList += "ml-5";
                var _i3 = [];
                var _iteratorNormalCompletion2 = true;
                var _didIteratorError2 = false;
                var _iteratorError2 = undefined;

                try {
                  for (var _iterator2 = b(e, _a6, t)[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
                    var _o7 = _step2.value;

                    if (t.data.hasOwnProperty(_o7)) {
                      var _a7 = document.createElement("a");

                      _a7.href = "https://" + ("en" === e.language ? "www" : e.language) + ".wowhead.com/", t.hasOwnProperty("spell_ids") && t.spell_ids.hasOwnProperty(_o7) && (_a7.href += "spell=" + t.spell_ids[_o7] + "/" + C(_o7)), _a7.appendChild(document.createTextNode(E(_o7, t, e))), _i3.push(_a7);
                    }
                  }
                } catch (err) {
                  _didIteratorError2 = true;
                  _iteratorError2 = err;
                } finally {
                  try {
                    if (!_iteratorNormalCompletion2 && _iterator2.return != null) {
                      _iterator2.return();
                    }
                  } finally {
                    if (_didIteratorError2) {
                      throw _iteratorError2;
                    }
                  }
                }

                for (var _e4 = 0; _e4 < _i3.length; _e4++) {
                  0 !== _e4 && _r3.appendChild(document.createTextNode(", ")), _r3.appendChild(_i3[_e4]);
                }

                _o6.appendChild(_r3);
              }
            }
          } catch (err) {
            _didIteratorError = true;
            _iteratorError = err;
          } finally {
            try {
              if (!_iteratorNormalCompletion && _iterator.return != null) {
                _iterator.return();
              }
            } finally {
              if (_didIteratorError) {
                throw _iteratorError;
              }
            }
          }
        });
      }

      try {
        $WowheadPower.refreshLinks();
      } catch (e) {}
    }(e, c), "secondary_distributions" === l) return function (e, t, o) {
      r && console.log("update_secondary_distribution_chart");
      var a = t.id,
          l = (e.chart_id, e.fight_style),
          n = e.wow_class,
          i = e.wow_spec,
          s = (e.chart_engine, !1);
      s = h(e), n = s.simc_settings.class, i = s.simc_settings.spec, l = s.simc_settings.fight_style;
      var d = k(e),
          c = !1;
      if ("highcharts" == e.chart_engine) try {
        c = Highcharts.chart(a, d);
      } catch (e) {
        return console.log("When trying to create a highcharts chart the following error occured. Did you include the necessary Highcharts scripts?"), void console.log(e);
      } else if ("highcharts_old" == e.chart_engine) try {
        var _e5 = d;
        _e5.chart.renderTo = a, c = new Highcharts.Chart(_e5);
      } catch (e) {
        return console.log("When trying to create a highcharts_old chart the following error occured. Did you include the necessary Highcharts scripts?"), void console.log(e);
      }
      o = void 0, o = c;
      var u = void 0;
      u = Object.keys(s.data)[0];
      var p = s.data[u][s.sorted_data_keys[u][0]],
          _ = s.data[u][s.sorted_data_keys[u][s.sorted_data_keys[u].length - 1]],
          g = x(100, 0, 100),
          m = x(0, 0, 100),
          f = {
        name: Intl.NumberFormat().format(p) + " DPS",
        color: "rgb(" + g[0] + "," + g[1] + "," + g[2] + ")",
        data: []
      };

      var _arr = Object.keys(s.data[u]);

      for (var _i4 = 0; _i4 < _arr.length; _i4++) {
        var _t3 = _arr[_i4];

        var _o8 = s.data[u][_t3],
            _a8 = x(_o8, _, p),
            _l4 = 1,
            _r4 = "#232227",
            _n2 = 5;

        p === _o8 && (_l4 = 3, _n2 = 8, _r4 = e.font_color);

        var _i5 = void 0;

        if (_t3.indexOf("70") > -1) switch (_i5 = {
          enabled: !0,
          allowOverlap: !0
        }, _t3.indexOf("70")) {
          case 0:
            _i5.format = "Crit", _i5.verticalAlign = "top";
            break;

          case 3:
            _i5.format = "Haste";
            break;

          case 6:
            _i5.format = "Mastery", _i5.verticalAlign = "top";
            break;

          case 9:
            _i5.format = "Versatility", _i5.verticalAlign = "top";
        }
        var _d2 = s.secondary_sum;

        var _c2 = parseInt(_t3.split("_")[0]),
            _h2 = parseInt(_t3.split("_")[1]),
            _g = parseInt(_t3.split("_")[2]),
            _m = parseInt(_t3.split("_")[3]);

        f.data.push({
          x: Math.sqrt(3) / 2 * (_c2 + 1 / 3 * _h2),
          y: Math.sqrt(2 / 3) * _h2,
          z: _g + .5 * _c2 + .5 * _h2,
          name: _t3,
          color: "rgb(" + _a8[0] + "," + _a8[1] + "," + _a8[2] + ")",
          dps: _o8,
          dps_max: p,
          dps_min: _,
          stat_crit: _c2 * _d2 / 100,
          stat_haste: _h2 * _d2 / 100,
          stat_mastery: _g * _d2 / 100,
          stat_vers: _m * _d2 / 100,
          stat_sum: _d2,
          marker: {
            radius: _n2,
            lineColor: _r4,
            lineWidth: _l4
          },
          dataLabels: _i5
        });
      }

      for (; o.series[0];) {
        o.series[0].remove(!1);
      }

      o.addSeries(f, !1), o.addSeries({
        name: Intl.NumberFormat().format(_) + " DPS",
        color: "rgb(" + m[0] + "," + m[1] + "," + m[2] + ")"
      }, !1);
      var b = s.timestamp,
          y = b.split("-")[0],
          w = b.split("-")[1],
          v = b.split("-")[2].split(" ")[0],
          C = b.split(" ")[1].split(":")[0],
          A = b.split(":")[1],
          T = "Last updated ",
          L = new Date() - new Date(Date.UTC(y, w - 1, v, C, A)),
          z = Math.floor(L / 24 / 3600 / 1e3);
      z > 0 && (T += "".concat(z, "d "));
      var E = Math.floor(L / 3600 / 1e3) - 24 * z;
      T += "".concat(E, "h ago"), o.redraw(), function (e) {
        function t(t) {
          var a = (t = o.pointer.normalize(t)).chartX,
              l = t.chartY,
              r = o.options.chart.options3d.alpha,
              n = o.options.chart.options3d.beta,
              i = 5;

          function s(e) {
            e = o.pointer.normalize(e), o.update({
              chart: {
                options3d: {
                  alpha: r + (e.chartY - l) / i,
                  beta: n + (a - e.chartX) / i
                }
              }
            }, void 0, void 0, !1);
          }

          o.unbindDragMouse = e.addEvent(document, "mousemove", s), o.unbindDragTouch = e.addEvent(document, "touchmove", s), e.addEvent(document, "mouseup", o.unbindDragMouse), e.addEvent(document, "touchend", o.unbindDragTouch);
        }

        e.addEvent(o.container, "mousedown", t), e.addEvent(o.container, "touchstart", t);
      }(Highcharts);
    }(e, t, o);
    "azerite_traits" === c.data_type ? -1 === l.indexOf("azerite_items") && (l = "azerite_traits_stacking") : l = c.data_type;
    var g = c;
    var m, f;
    if (l.indexOf("azerite_traits") > -1) {
      if ("azerite_traits_stacking" === l) "all" === e.azerite_tier ? m = g.sorted_data_keys_2.slice(0, n) : "1" === e.azerite_tier || "3" === e.azerite_tier ? m = g.sorted_azerite_tier_3_trait_stacking.slice(0, n) : "2" === e.azerite_tier && (m = g.sorted_azerite_tier_2_trait_stacking.slice(0, n)), f = g.data.baseline[g.simulated_steps[0]];else {
        if ("azerite_traits_itemlevel" !== l) return void console.log("Chart found, but unknown data-type detected.");
        "all" === e.azerite_tier ? m = g.sorted_data_keys.slice(0, n) : "1" === e.azerite_tier || "3" === e.azerite_tier ? m = g.sorted_azerite_tier_3_itemlevel.slice(0, n) : "2" === e.azerite_tier && (m = g.sorted_azerite_tier_2_itemlevel.slice(0, n)), f = g.data.baseline[g.simulated_steps[g.simulated_steps.length - 1]];
      }
    } else m = "soulbinds" === l ? "nodes" === e.chart_mode ? g["sorted_data_keys_" + C(e.covenant).replace("-", "_") + "_" + e.conduit_rank].slice(0, n) : g.sorted_data_keys[e.conduit_rank].slice(0, n) : g.sorted_data_keys.slice(0, n), f = ["races", "talents"].includes(l) ? 0 : ["soulbinds"].includes(l) && "nodes" === e.chart_mode ? g.data.baseline[e.covenant] : ["legendaries", "soulbind_nodes", "soulbinds", "covenants"].includes(l) ? g.data.baseline : g.data.baseline[g.simulated_steps[g.simulated_steps.length - 1]];

    for (r && (console.log(m), console.log("Baseline dps: " + f)), "soulbinds" === l && "nodes" !== e.chart_mode && (m = y(e, _(e, g), g)), o.setTitle({
      text: g.title
    }, {
      text: g.subtitle
    }, !1); o.series[0];) {
      o.series[0].remove(!1);
    }

    var T = void 0;
    T = "talents" === l ? m.map(function (t) {
      var o = [];

      for (var _a9 = 0; _a9 < t.length; _a9++) {
        o.push(v(e, (_a9 + 1).toString() + t[_a9], g));
      }

      return o.join("");
    }) : m.map(function (t) {
      return v(e, t, g);
    }), r && console.log(T), "highcharts" == i ? o.update({
      xAxis: {
        categories: T
      }
    }, !1) : "highcharts_old" == i && o.xAxis[0].setCategories(T, !1);
    var H = [];

    if ("azerite_traits_stacking" == l) {
      var _e6 = g.simulated_steps[0].replace("1_", "");

      H.push("3_" + _e6), H.push("2_" + _e6), H.push("1_" + _e6);
    } else H = "soulbinds" == l && "soulbinds" === e.chart_mode ? void 0 : g.simulated_steps;

    if (r && console.log("simulated_steps: " + H), H) {
      var _t4 = {};

      for (var _o9 in g.data) {
        if (g.data.hasOwnProperty(_o9)) {
          var _a10 = g.data[_o9];
          _t4[_o9] = {};
          var _r5 = f;
          "conduits" === l ? _r5 = g.data.baseline[g.covenant_mapping[_o9]] : "soulbinds" === l && "nodes" === e.chart_mode && (_r5 = g.data.baseline[e.covenant]);

          for (var _l5 = H.length - 1; _l5 >= 0; _l5--) {
            var _n3 = H[_l5];

            var _i6 = _a10.hasOwnProperty(e.covenant) ? _a10[e.covenant] : _a10;

            Number.isInteger(_i6) ? (_t4[_o9][_n3] = _i6 - _r5, _r5 = _i6) : _i6.hasOwnProperty(_n3) ? (_t4[_o9][_n3] = _i6[_n3] - _r5, _r5 = _i6[_n3]) : _t4[_o9][_n3] = 0;
          }
        }
      }

      var _iteratorNormalCompletion3 = true;
      var _didIteratorError3 = false;
      var _iteratorError3 = undefined;

      try {
        for (var _iterator3 = H[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
          var _a11 = _step3.value;
          var _r6 = [];

          for (var _o10 = 0; _o10 < m.length; _o10++) {
            var _l6 = m[_o10];

            _r6.push(w(e, _t4[_l6][_a11], f));
          }

          var _n4 = _a11;
          ["azerite_items_chest", "azerite_items_head", "azerite_items_shoulders", "azerite_traits_itemlevel"].indexOf(l) > -1 ? _n4 = _a11.split("_")[1] : "azerite_traits_stacking" === l ? _n4 = _a11.split("_")[0] : "soulbinds" === l && "nodes" === e.chart_mode && (_n4 = d[_n4]), o.addSeries({
            data: _r6,
            name: _n4
          }, !1);
        }
      } catch (err) {
        _didIteratorError3 = true;
        _iteratorError3 = err;
      } finally {
        try {
          if (!_iteratorNormalCompletion3 && _iterator3.return != null) {
            _iterator3.return();
          }
        } finally {
          if (_didIteratorError3) {
            throw _iteratorError3;
          }
        }
      }
    } else if (["legendaries", "soulbind_nodes", "covenants"].includes(l)) {
      var N = [];

      for (var _t5 = 0; _t5 < m.length; _t5++) {
        var _o11 = m[_t5],
            _a12 = g.data[_o11] - f;

        N.push(w(e, _a12, f));
      }

      o.addSeries({
        data: N,
        name: "Data",
        showInLegend: !1
      }, !1);
    } else if (["soulbinds"].includes(l) && "soulbinds" === e.chart_mode) {
      var _iteratorNormalCompletion4 = true;
      var _didIteratorError4 = false;
      var _iteratorError4 = undefined;

      try {
        for (var _iterator4 = Object.keys(s).sort().reverse()[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {
          var _t6 = _step4.value;
          var _a13 = s[_t6].id;
          var _l7 = [];

          for (var _t7 = 0; _t7 < m.length; _t7++) {
            var _o12 = m[_t7],
                _r7 = 0;
            g.covenant_mapping[_o12][0] === _a13 && (_r7 = p(e, _o12, g)), _l7.push(_r7);
          }

          o.addSeries({
            data: _l7,
            name: E(_t6, g, e),
            showInLegend: !0,
            color: s[_t6].color
          }, !1);
        }
      } catch (err) {
        _didIteratorError4 = true;
        _iteratorError4 = err;
      } finally {
        try {
          if (!_iteratorNormalCompletion4 && _iterator4.return != null) {
            _iterator4.return();
          }
        } finally {
          if (_didIteratorError4) {
            throw _iteratorError4;
          }
        }
      }
    } else {
      N = [];

      for (var _t8 = 0; _t8 < m.length; _t8++) {
        var _o13 = m[_t8],
            _a14 = g.data[_o13];
        "soulbinds" === l && (_a14 = g.data[_o13][e.conduit_rank]), N.push(_a14);
      }

      o.addSeries({
        data: N,
        name: "DPS",
        showInLegend: !1
      }, !1);
    }

    ["trinkets", "azerite_items_chest", "azerite_items_head", "azerite_items_shoulders", "azerite_traits_itemlevel"].indexOf(l) > -1 ? o.legend.title.attr({
      text: "Itemlevel"
    }) : "races" === l ? o.legend.title.attr({
      text: ""
    }) : "azerite_traits_stacking" === l ? o.legend.title.attr({
      text: "Trait count"
    }) : "soulbinds" === l && "nodes" === e.chart_mode && o.legend.title.attr({
      text: "Conduit Rank"
    }), o.redraw(), "highcharts_old" == i && o.reflow(), t.style.height = 200 + 30 * m.length + "px", "highcharts" == i && o.setSize(t.style.width, t.style.height), "wowdb" == e.tooltip_engine && setTimeout(function () {
      !function (e) {
        r && console.log("readd_wowdb_tooltips");

        try {
          CurseTips["wowdb-tooltip"].watchElements(document.getElementById(e).getElementsByTagName("a"));
        } catch (e) {
          console.log("Setting wowdb (CurseTips) tooltips failed. Error: ", e);
        }
      }(t.id);
    }, 1);
  }

  function p(e, t, o) {
    var a = g(t, o),
        l = m(e, t, o),
        r = o.data.baseline[a],
        n = f(e, t, l, o),
        i = n.indexOf(Math.max.apply(Math, _toConsumableArray(n)));
    return r + n[i];
  }

  function _(e, t) {
    return t.sorted_data_keys[e.conduit_rank].filter(function (o) {
      return t.renowns[o][0] <= e.renown;
    });
  }

  function g(e, t) {
    return covenant = Object.entries(t.covenant_ids).filter(function (o) {
      return o[1] === t.covenant_mapping[e][0];
    })[0][0];
  }

  function m(e, t, o) {
    return o.paths[t].slice(0, o.paths[t].length).map(function (a) {
      return a.filter(function (a, l) {
        return o.renowns[t][l] <= e.renown;
      });
    });
  }

  function f(e, t, o, a) {
    var l = g(t, a),
        r = a.data.baseline[l];
    return o.map(function (t) {
      var o = t.map(function (e, t) {
        return [e, t];
      }).filter(function (e) {
        return "Potency Conduit" === e[0];
      }).map(function (e) {
        return e[1];
      });
      return t.map(function (t, n) {
        var i = 0;

        try {
          i = a.data[t][l] - r;
        } catch (e) {}

        if ("Potency Conduit" === t) {
          var _t9 = "sorted_data_keys_" + C(l).replace("-", "_") + "_" + e.conduit_rank;

          i = a.data[a[_t9].filter(function (e) {
            return a.conduits.indexOf(e) > -1;
          })[o.indexOf(n)]][l][e.conduit_rank] - r;
        }

        return i;
      }).reduce(function (e, t) {
        return e + t;
      }, 0);
    });
  }

  function b(e, t, o) {
    var a = m(e, t, o),
        l = f(e, t, a, o),
        r = a[l.indexOf(Math.max.apply(Math, _toConsumableArray(l)))],
        n = r.map(function (e, t) {
      return [e, t];
    }).filter(function (e) {
      return "Potency Conduit" === e[0];
    }).map(function (e) {
      return e[1];
    });
    return r.map(function (t, a) {
      if ("Potency Conduit" === t) {
        var _t10 = "sorted_data_keys_" + C(covenant).replace("-", "_") + "_" + e.conduit_rank;

        return o[_t10].filter(function (e) {
          return o.conduits.indexOf(e) > -1;
        })[n.indexOf(a)];
      }

      return t;
    });
  }

  function y(e, t, o) {
    return t.map(function (t) {
      return [t, p(e, t, o)];
    }).sort(function (e, t) {
      return t[1] - e[1];
    }).map(function (e) {
      return e[0];
    });
  }

  function w(e, t, o) {
    return "absolute" === e.value_style ? t : "relative" === e.value_style ? Math.round(1e4 * t / o) / 100 : void console.error("Unknown value-style", e.value_style);
  }

  function x(e, t, o) {
    r && console.log("create_color");
    var a = [0, 255, 255],
        l = [255, 255, 0],
        n = [255, 0, 0],
        i = 0,
        s = 0;

    for (var _e7 = 0; _e7 < 3; _e7++) {
      i += Math.abs(n[_e7] - l[_e7]), s += Math.abs(l[_e7] - a[_e7]);
    }

    var d = t + (o - t) * (s / (s + i));

    if (e >= d) {
      var _t11 = (e - d) / (o - d);

      return [Math.floor(n[0] * _t11 + l[0] * (1 - _t11)), Math.floor(n[1] * _t11 + l[1] * (1 - _t11)), Math.floor(n[2] * _t11 + l[2] * (1 - _t11))];
    }

    {
      var _o14 = (e - t) / (d - t);

      return [Math.floor(l[0] * _o14 + a[0] * (1 - _o14)), Math.floor(l[1] * _o14 + a[1] * (1 - _o14)), Math.floor(l[2] * _o14 + a[2] * (1 - _o14))];
    }
  }

  function v(e, t, o) {
    if (r && (console.log("get_category_name"), console.log(t)), "wowhead" != e.tooltip_engine && "wowdb" != e.tooltip_engine) return E(t, o, e);
    if (["races"].includes(e.data_type)) return E(t, o, e);

    if (["soulbinds"].includes(e.data_type) && "soulbinds" === e.chart_mode) {
      var _a15 = '<a href="#' + t + '">';

      return _a15 += E(t, o, e), _a15 += "</a>";
    }

    if ("wowhead" == e.tooltip_engine) {
      var _a16 = document.createElement("a");

      if (_a16.href = "https://" + ("en" === e.language ? "www" : e.language) + ".wowhead.com/", o.hasOwnProperty("item_ids") && o.item_ids.hasOwnProperty(t)) {
        if (_a16.href += "item=" + o.item_ids[t] + "/" + C(t), o.hasOwnProperty("class_id") && o.hasOwnProperty("used_azerite_traits_per_item")) {
          _a16.href += "?azerite-powers=" + o.class_id;

          for (var _e9 = 0; _e9 < o.used_azerite_traits_per_item[t].length; _e9++) {
            var _l8 = o.used_azerite_traits_per_item[t][_e9];
            _a16.href += ":" + _l8.id;
          }
        }

        var _e8 = o.simulated_steps[o.simulated_steps.length - 1];
        "string" == typeof _e8 && _e8.indexOf("_") > -1 && (_e8 = _e8.split("_")[1]), _a16.href += "&ilvl=" + _e8;
      } else if (o.hasOwnProperty("spell_ids") && o.spell_ids.hasOwnProperty(t)) _a16.href += "spell=" + o.spell_ids[t] + "/" + C(t);else if ("talents" === e.data_type) {
        if ("0" === t[1]) return t[1];
        _a16.href += "spell=" + o.talent_data[t[0]][t[1]].spell_id;
      }

      return "talents" === e.data_type ? _a16.appendChild(document.createTextNode(t[1])) : _a16.appendChild(document.createTextNode(E(t, o, e))), _a16.outerHTML;
    }

    if ("wowdb" == e.tooltip_engine) {
      var _a17 = document.createElement("a");

      _a17.href = "http://www.wowdb.com/";

      try {
        _a17.href += "items/" + o.item_ids[t];
      } catch (e) {
        r && (console.log(e), console.log("We're probably looking at a spell."));
      }

      if (_a17.href.indexOf("items") > -1) {
        var _e10 = o.simulated_steps[o.simulated_steps.length - 1];

        if ("string" == typeof _e10 && _e10.indexOf("_") > -1 && (_e10 = _e10.split("_")[1]), _a17.href += "?itemLevel=" + _e10, o.hasOwnProperty("class_id") && o.hasOwnProperty("used_azerite_traits_per_item")) {
          _a17.href += "&azerite=", _a17.href += o.class_id + ":0";

          for (var _e11 = 0; _e11 < o.used_azerite_traits_per_item[t].length; _e11++) {
            var _l10 = o.used_azerite_traits_per_item[t][_e11];
            _a17.href += ":" + _l10.id;
          }
        }
      }

      try {
        _a17.href += "spells/" + o.spell_ids[t];
      } catch (e) {
        r && (console.log(e), console.log("We're probably looking at an item."));
      }

      if ("talents" === e.data_type) {
        if ("0" === t[1]) return t[1];
        _a17.href += "spells/" + o.talent_data[t[0]][t[1]].spell_id;
      }

      _a17.dataset.tooltipHref = _a17.href;

      var _l9 = void 0;

      return _l9 = "talents" === e.data_type ? t[1] : E(t, o, e), _a17.appendChild(document.createTextNode(_l9)), _a17.outerHTML;
    }
  }

  function C(e) {
    return e.toString().toLowerCase().replace(/\s+/g, "-").replace(/[^\w\-]+/g, "").replace(/\-\-+/g, "-").replace(/^-+/, "").replace(/-+$/, "");
  }

  function k(n) {
    if (r && console.log("update_chart_style"), "highcharts" == n.chart_engine || "highcharts_old" == n.chart_engine) {
      if ("secondary_distributions" === n.data_type) return {
        chart: {
          renderTo: "scatter_plot_chart",
          type: "scatter3d",
          backgroundColor: null,
          animation: !1,
          height: 800,
          width: 800,
          options3d: {
            enabled: !0,
            alpha: 10,
            beta: 30,
            depth: 800,
            fitToPlot: !1
          }
        },
        legend: {
          enabled: !0,
          backgroundColor: n.background_color,
          borderColor: n.font_color,
          borderWidth: 1,
          align: "right",
          verticalAlign: "middle",
          layout: "vertical",
          itemStyle: {
            color: n.font_color
          },
          itemHoverStyle: {
            color: n.font_color
          }
        },
        plotOptions: {
          series: {
            dataLabels: {
              allowOverlap: !0,
              style: {
                color: n.font_color,
                fontSize: n.font_size,
                fontWeight: "400",
                textOutline: ""
              }
            },
            events: {
              legendItemClick: function legendItemClick() {
                return !1;
              }
            }
          }
        },
        series: [],
        title: {
          text: "",
          useHTML: !0,
          style: {
            color: n.font_color
          }
        },
        subtitle: {
          text: "",
          useHTML: !0,
          style: {
            color: n.font_color,
            fontSize: n.font_size
          }
        },
        tooltip: {
          headerFormat: "",
          pointFormatter: function pointFormatter() {
            return '<table class="">                <thead>                  <tr>                    <th scope="col"></th>                    <th scope="col">Absolute</th>                    <th scope="col">Relative</th>                  </tr>                </thead>                <tbody>                  <tr>                    <th scope="row">DPS</th>                    <td>' + Intl.NumberFormat().format(this.dps) + "</td>                    <td>" + Math.round(this.dps / this.dps_max * 1e4) / 100 + '%</td>                  </tr>                  <tr>                    <th scope="row">Crit</th>                    <td>' + Intl.NumberFormat().format(this.stat_crit) + "</td>                    <td>" + this.name.split("_")[0] + '%</td>                  </tr>                  <tr>                    <th scope="row">Haste</th>                    <td>' + Intl.NumberFormat().format(this.stat_haste) + "</td>                    <td>" + this.name.split("_")[1] + '%</td>                  </tr>                  <tr>                    <th scope="row">Mastery</th>                    <td>' + Intl.NumberFormat().format(this.stat_mastery) + "</td>                    <td>" + this.name.split("_")[2] + '%</td>                  </tr>                  <tr>                    <th scope="row">Versatility</th>                    <td>' + Intl.NumberFormat().format(this.stat_vers) + "</td>                    <td>" + this.name.split("_")[3] + "%</td>                  </tr>                </tbody>              </table>";
          },
          useHTML: !0,
          borderColor: n.background_color
        },
        xAxis: {
          min: 0,
          max: 80,
          tickInterval: 20,
          startOnTick: !0,
          endOnTick: !0,
          title: "",
          labels: {
            enabled: !1
          },
          gridLineWidth: 1,
          gridLineColor: n.axis_color
        },
        yAxis: {
          min: -10,
          max: 70,
          tickInterval: 20,
          startOnTick: !0,
          endOnTick: !0,
          title: "",
          labels: {
            enabled: !1
          },
          gridLineWidth: 1,
          gridLineColor: n.axis_color
        },
        zAxis: {
          min: 10,
          max: 90,
          tickInterval: 20,
          startOnTick: !0,
          endOnTick: !0,
          title: "",
          labels: {
            enabled: !1
          },
          reversed: !0,
          gridLineWidth: 1,
          gridLineColor: n.axis_color
        }
      };
      var _r8 = n.background_color,
          _i7 = n.axis_color,
          _s2 = n.font_color,
          _d3 = "https://bloodmallet.com/";
      void 0 !== n.chart_id ? _d3 += "chart/" + n.chart_id : void 0 !== n.wow_class && void 0 !== n.wow_spec && (_d3 += "#" + n.wow_class + "_" + n.wow_spec);
      var _c3 = {
        chart: {
          type: "bar",
          backgroundColor: t,
          style: {
            fontFamily: '-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"'
          }
        },
        colors: e,
        credits: {
          href: _d3,
          text: "bloodmallet",
          style: {
            fontSize: l
          }
        },
        legend: {
          align: "right",
          backgroundColor: t,
          borderColor: a,
          borderWidth: 1,
          floating: !1,
          itemMarginBottom: 3,
          itemMarginTop: 0,
          layout: "vertical",
          reversed: !0,
          shadow: !1,
          verticalAlign: "middle",
          x: 0,
          y: 0,
          itemStyle: {
            color: o
          },
          itemHoverStyle: {
            color: o
          },
          title: {
            text: " ",
            style: {
              color: o
            }
          },
          symbolRadius: 0
        },
        plotOptions: {
          series: {
            stacking: "normal",
            borderColor: t,
            events: {
              legendItemClick: function legendItemClick() {
                return !1;
              }
            },
            style: {
              textOutline: !1,
              fontSize: l
            }
          }
        },
        series: [],
        title: {
          text: "Loading data...",
          useHTML: !0,
          style: {
            color: o,
            fontSize: l
          }
        },
        subtitle: {
          text: '...from <a href="https://bloodmallet.com">bloodmallet</a>',
          useHTML: !0,
          style: {
            color: o,
            fontSize: l
          }
        },
        tooltip: {
          headerFormat: "<b>{point.x}</b>",
          shared: !0,
          backgroundColor: t,
          borderColor: a,
          style: {
            color: o,
            fontSize: l
          },
          useHTML: !0
        },
        xAxis: {
          categories: [],
          labels: {
            useHTML: !0,
            style: {
              color: o,
              fontSize: l
            }
          },
          gridLineWidth: 0,
          gridLineColor: a,
          lineColor: a,
          tickColor: a
        },
        yAxis: [{
          labels: {
            style: {
              color: a
            }
          },
          min: 0,
          stackLabels: {
            enabled: !0,
            formatter: function formatter() {
              return Intl.NumberFormat().format(this.total);
            },
            style: {
              color: o,
              textOutline: !1,
              fontSize: l,
              fontWeight: "normal"
            }
          },
          title: {
            text: "absolute" === n.value_style ? "Δ Damage per second" : "% Damage per second",
            style: {
              color: a
            }
          },
          gridLineWidth: 1,
          gridLineColor: a
        }, {
          linkedTo: 0,
          opposite: !0,
          labels: {
            style: {
              color: a
            }
          },
          min: 0,
          stackLabels: {
            enabled: !0,
            formatter: function formatter() {
              return Intl.NumberFormat().format(this.total);
            },
            style: {
              color: o,
              textOutline: !1,
              fontSize: l,
              fontWeight: "normal"
            }
          },
          title: {
            text: "absolute" === n.value_style ? "Δ Damage per second" : "% Damage per second",
            style: {
              color: a
            }
          },
          gridLineWidth: 1,
          gridLineColor: a
        }]
      };
      return _c3.chart.backgroundColor = _r8, _c3.legend.backgroundColor = _r8, _c3.legend.borderColor = _i7, _c3.legend.itemStyle.color = _s2, _c3.legend.itemHoverStyle.color = _s2, _c3.title.style.color = _s2, _c3.subtitle.style.color = _s2, _c3.tooltip.formatter = function () {
        var e = document.createElement("div");
        e.style.margin = "-4px -7px -7px -7px", e.style.padding = "3px 3px 6px 3px", e.style.backgroundColor = "transparent" !== _r8 ? _r8 : t, "highcharts_old" === n.chart_engine && (e.style.margin = "-7px");
        var o = document.createElement("div");
        e.appendChild(o), o.style.marginLeft = "9px", o.style.marginRight = "9px", o.style.marginBottom = "6px", o.style.fontWeight = "700", o.innerHTML = this.x;
        var a = 0;

        for (var l = this.points.length - 1; l >= 0; l--) {
          if (a += this.points[l].y, 0 !== this.points[l].y) {
            var _t12 = document.createElement("div");

            e.appendChild(_t12);

            var _o15 = document.createElement("span");

            _t12.appendChild(_o15), _o15.style.marginLeft = "9px", _o15.style.borderLeft = "9px solid " + this.points[l].series.color, _o15.style.paddingLeft = "4px", Number.isInteger(this.points[l].series.name) && _o15.appendChild(document.createTextNode(this.points[l].series.name + ":")), _t12.appendChild(document.createTextNode("  " + Intl.NumberFormat().format(a) + ("relative" === n.value_style ? "%" : "")));
          }
        }

        return e.outerHTML;
      }, _c3.tooltip.backgroundColor = "transparent" !== _r8 ? _r8 : t, _c3.tooltip.borderColor = _i7, _c3.tooltip.style.color = _s2, _c3.xAxis.labels.style.color = _s2, _c3.xAxis.gridLineColor = _i7, _c3.xAxis.lineColor = _i7, _c3.xAxis.tickColor = _i7, _c3.yAxis[0].labels.style.color = _i7, _c3.yAxis[0].stackLabels.style.color = _s2, _c3.yAxis[0].gridLineColor = _i7, _c3.yAxis[0].lineColor = _i7, _c3.yAxis[0].tickColor = _i7, _c3.yAxis[0].title.style.color = _i7, _c3.yAxis[1].labels.style.color = _i7, _c3.yAxis[1].stackLabels.style.color = _s2, _c3.yAxis[1].gridLineColor = _i7, _c3.yAxis[1].lineColor = _i7, _c3.yAxis[1].tickColor = _i7, _c3.yAxis[1].title.style.color = _i7, _c3.credits.style.color = _s2, _c3;
    }
  }

  function A(e, t, o) {
    var a = document.createElement("div");
    a.innerHTML = e + ": ";
    var l = document.createElement("span");

    if (l.innerHTML = t + "%", l.classList += T(t >= 0 ? t : 3 - t), void 0 !== o) {
      l.title = "Talent combination: " + o, l.setAttribute("data-toggle", "tooltip"), l.setAttribute("data-placement", "bottom");

      var _e12 = document.createElement("span");

      _e12.classList += "priest-color", _e12.innerHTML = " (?)", l.appendChild(_e12);
    }

    return a.appendChild(l), a;
  }

  function T(e) {
    return r && console.log("get_value_color"), e < 5 ? "mage-color" : e > 10 && e <= 12 ? "druid-color" : e > 12 ? "death_knight-color" : "monk-color";
  }

  function L(e, t) {
    var _iteratorNormalCompletion5 = true;
    var _didIteratorError5 = false;
    var _iteratorError5 = undefined;

    try {
      for (var _iterator5 = t.sorted_data_keys[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {
        var _o16 = _step5.value;
        if (_o16[e.slice(0, 1) - 1] === e.slice(1, 2)) return _o16;
      }
    } catch (err) {
      _didIteratorError5 = true;
      _iteratorError5 = err;
    } finally {
      try {
        if (!_iteratorNormalCompletion5 && _iterator5.return != null) {
          _iterator5.return();
        }
      } finally {
        if (_didIteratorError5) {
          throw _iteratorError5;
        }
      }
    }

    return !1;
  }

  function z(e, t, o, a) {
    var l = '<a href="https://';
    return "en" === e.language || "EN" === e.language ? l += "www" : l += e.language.toLowerCase(), l += ".wowhead.com/spell=", l += a.talent_data[o.slice(0, 1)][o.slice(1, 2)].spell_id, l += '"', l += ">", l += E(t, a, e), l += "</a>";
  }

  function E(e, t, o) {
    r && console.log("get_translated_name " + e);
    var a = "";

    try {
      a = t.translations[e][i[o.language]];
    } catch (t) {
      r && (console.log("No translation for ".concat(e, " found.")), console.log(t)), a = e;
    }

    return r && console.log("Translated name: " + a), void 0 === a && (a = e), a;
  }

  function O(e, t) {
    var o = e.slice(0, 1),
        a = e.slice(1, 2),
        l = 100,
        r = "";
    var _iteratorNormalCompletion6 = true;
    var _didIteratorError6 = false;
    var _iteratorError6 = undefined;

    try {
      for (var _iterator6 = t.sorted_data_keys[Symbol.iterator](), _step6; !(_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done); _iteratorNormalCompletion6 = true) {
        var _e13 = _step6.value;

        if (_e13[o - 1] === a) {
          var _a18 = t.data[_e13],
              _n5 = t.data[_e13.slice(0, o - 1) + "0" + _e13.slice(o, 8)];

          l > S(_n5, _a18) && (l = S(_n5, _a18), r = _e13);
        }
      }
    } catch (err) {
      _didIteratorError6 = true;
      _iteratorError6 = err;
    } finally {
      try {
        if (!_iteratorNormalCompletion6 && _iterator6.return != null) {
          _iterator6.return();
        }
      } finally {
        if (_didIteratorError6) {
          throw _iteratorError6;
        }
      }
    }

    return [r, l];
  }

  function M(e, t) {
    var o = e.slice(0, 1),
        a = e.slice(1, 2),
        l = -100,
        r = "";
    var _iteratorNormalCompletion7 = true;
    var _didIteratorError7 = false;
    var _iteratorError7 = undefined;

    try {
      for (var _iterator7 = t.sorted_data_keys[Symbol.iterator](), _step7; !(_iteratorNormalCompletion7 = (_step7 = _iterator7.next()).done); _iteratorNormalCompletion7 = true) {
        var _e14 = _step7.value;

        if (_e14[o - 1] === a) {
          var _a19 = t.data[_e14],
              _n6 = t.data[_e14.slice(0, o - 1) + "0" + _e14.slice(o, 8)];

          l < S(_n6, _a19) && (l = S(_n6, _a19), r = _e14);
        }
      }
    } catch (err) {
      _didIteratorError7 = true;
      _iteratorError7 = err;
    } finally {
      try {
        if (!_iteratorNormalCompletion7 && _iterator7.return != null) {
          _iterator7.return();
        }
      } finally {
        if (_didIteratorError7) {
          throw _iteratorError7;
        }
      }
    }

    return [r, l];
  }

  function I(e, t) {
    r && console.log("get_average_gain");
    var o = [];
    var _iteratorNormalCompletion8 = true;
    var _didIteratorError8 = false;
    var _iteratorError8 = undefined;

    try {
      for (var _iterator8 = t.sorted_data_keys[Symbol.iterator](), _step8; !(_iteratorNormalCompletion8 = (_step8 = _iterator8.next()).done); _iteratorNormalCompletion8 = true) {
        var _a20 = _step8.value;
        _a20[e.slice(0, 1) - 1] === e.slice(1, 2) && o.push(_a20);
      }
    } catch (err) {
      _didIteratorError8 = true;
      _iteratorError8 = err;
    } finally {
      try {
        if (!_iteratorNormalCompletion8 && _iterator8.return != null) {
          _iterator8.return();
        }
      } finally {
        if (_didIteratorError8) {
          throw _iteratorError8;
        }
      }
    }

    var a = 0;

    for (var _i8 = 0; _i8 < o.length; _i8++) {
      var _l11 = _o17[_i8];
      var _o17 = t.data[_l11];
      a += S(t.data[_l11.slice(0, e.slice(0, 1) - 1) + "0" + _l11.slice(e.slice(0, 1), 8)], _o17);
    }

    return Math.round(a / o.length * 100) / 100;
  }

  function S(e, t) {
    return r && console.log("get_percentage_gain"), Math.round(100 * (100 * t / e - 100)) / 100;
  }

  this.init_charts = new function () {
    r && console.log("init_charts");
    var e = document.querySelectorAll("div.bloodmallet_chart"),
        l = [];

    for (var _t13 = 0; _t13 < e.length; _t13++) {
      var _o18 = e[_t13];
      if (l.indexOf(_o18.id) > -1) return void console.error("Multiple Elements use the same ID ('" + _o18.id + "'). Aborting bloodmallet_chart_import.js.");
      l.push(_o18.id);
    }

    for (var _l12 = 0; _l12 < e.length; _l12++) {
      var _n7 = void 0;

      try {
        _n7 = e[_l12].id;
      } catch (e) {
        return void console.error("Each .bloodmallet_chart needs an ID. Aborting bloodmallet_chart_import.js.");
      }

      var _i9 = document.getElementById(e[_l12].id);

      if (_i9) {
        var _e15 = {
          chart_id: void 0,
          wow_class: void 0,
          wow_spec: void 0,
          data_type: "trinkets",
          azerite_tier: "all",
          conduit_rank: "7",
          fight_style: "castingpatchwerk",
          chart_mode: "soulbinds",
          covenant: "Kyrian",
          renown: "35",
          axis_color: a,
          background_color: t,
          font_color: o,
          limit: 7,
          chart_engine: "highcharts",
          tooltip_engine: "wowhead",
          language: "en",
          value_style: "absolute",
          html_element: _i9
        };

        try {
          void 0 !== bloodmallet.style.axis_color && (_e15.axis_color = bloodmallet.style.axis_color), void 0 !== bloodmallet.style.background_color && (_e15.background_color = bloodmallet.style.background_color), void 0 !== bloodmallet.style.font_color && (_e15.font_color = bloodmallet.style.font_color), void 0 !== bloodmallet.settings.entries && (_e15.limit = bloodmallet.settings.entries), void 0 !== bloodmallet.settings.chart_engine && (_e15.chart_engine = bloodmallet.settings.chart_engine), void 0 !== bloodmallet.settings.tooltip_engine && (_e15.tooltip_engine = bloodmallet.settings.tooltip_engine), void 0 !== bloodmallet.settings.language && (_e15.language = bloodmallet.settings.language), void 0 !== bloodmallet.settings.value_style && (_e15.value_style = bloodmallet.settings.value_style);
        } catch (e) {
          r && console.log("Applying page wide settings failed or no page wide settings were found.");
        }

        _i9.getAttribute("data-entries") && (_e15.limit = _i9.getAttribute("data-entries")), _i9.getAttribute("data-fight-style") && (_e15.fight_style = _i9.getAttribute("data-fight-style")), _i9.getAttribute("data-type") && (_e15.data_type = _i9.getAttribute("data-type")), _i9.getAttribute("data-chart-mode") && (_e15.chart_mode = _i9.getAttribute("data-chart-mode")), _i9.getAttribute("data-covenant") && (_e15.covenant = _i9.getAttribute("data-covenant")), _i9.getAttribute("data-renown") && (_e15.renown = _i9.getAttribute("data-renown")), _i9.getAttribute("data-azerite-tier") && (_e15.azerite_tier = _i9.getAttribute("data-azerite-tier")), _i9.getAttribute("data-conduit-rank") && (_e15.conduit_rank = _i9.getAttribute("data-conduit-rank")), _i9.getAttribute("data-background-color") && (_e15.background_color = _i9.getAttribute("data-background-color")), _i9.getAttribute("data-font-color") && (_e15.font_color = _i9.getAttribute("data-font-color")), _i9.getAttribute("data-axis-color") && (_e15.axis_color = _i9.getAttribute("data-axis-color")), _i9.getAttribute("data-tooltip-engine") && (_e15.tooltip_engine = _i9.getAttribute("data-tooltip-engine")), _i9.getAttribute("data-chart-engine") && (_e15.chart_engine = _i9.getAttribute("data-chart-engine")), _i9.getAttribute("data-language") && (_e15.language = _i9.getAttribute("data-language")), _i9.getAttribute("data-value-style") && (_e15.value_style = _i9.getAttribute("data-value-style"));

        var _l13 = !0;

        _i9.getAttribute("data-chart-id") ? _e15.chart_id = _i9.getAttribute("data-chart-id") : (_i9.getAttribute("data-wow-class") || (console.error("Required 'data-chart-id' or 'data-wow-class' attribute wasn't found in " + _n7 + "."), _l13 = !1), _e15.wow_class = _i9.getAttribute("data-wow-class"), _i9.getAttribute("data-wow-spec") || (console.error("Required 'data-chart-id' or 'data-wow-spec' attribute wasn't found in " + _n7 + "."), _l13 = !1), _e15.wow_spec = _i9.getAttribute("data-wow-spec"));

        var _s3 = k(_e15),
            _d4 = !1;

        if ("highcharts" == _e15.chart_engine) try {
          _d4 = Highcharts.chart(_n7, _s3);
        } catch (e) {
          return console.log("When trying to create a highcharts chart the following error occured. Did you include the necessary Highcharts scripts?"), void console.log(e);
        } else if ("highcharts_old" == _e15.chart_engine) try {
          var _e16 = _s3;
          _e16.chart.renderTo = _n7, _d4 = new Highcharts.Chart(_e16);
        } catch (e) {
          return console.log("When trying to create a highcharts_old chart the following error occured. Did you include the necessary Highcharts scripts?"), void console.log(e);
        }
        _l13 ? c(_e15) : _d4.setTitle({
          text: "Wrong chart setup"
        }, {
          text: "Missing 'data-chart-id', 'data-wow-class' or 'data-wow-spec'. See <a href=\"https://github.com/Bloodmallet/bloodmallet_web_frontend/wiki/How-to-import-charts\">wiki</a>"
        }), setTimeout(u, 1, _e15, _i9, _d4, 0);
      }
    }
  }();
}

document.addEventListener("DOMContentLoaded", function () {
  bloodmallet_chart_import();
});